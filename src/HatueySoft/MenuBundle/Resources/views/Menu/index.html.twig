{% extends '@HatueySoftMenu/layout.html.twig' %}

{% block stylesheets %}
    {{ parent() }}
    <link rel="stylesheet" href="{{ asset('bundles/hatueysoftmenu/vendors/fuelux/css/treeview.css') }}" media="screen">
{% endblock %}

{% block title 'Menu tree' %}

{% block headline block('title') %}

{% block content -%}
    <div id="MyTree" class="tree">
        <div class="tree-folder" style="display: none;">
            <div class="tree-folder-header">
                <i class="fa fa-folder"></i>
                <div class="tree-folder-name"></div>
            </div>
            <div class="tree-folder-content">
            </div>
            <div class="tree-loader" style="display: none;"></div>
        </div>
        <div class="tree-item" style="display: none;">
            <i class="tree-dot"></i>
            <div class="tree-item-name"></div>
        </div>
    </div>
{% endblock %}

{% block javascripts %}
    <script src="{{ asset('bundles/hatueysoftmenu/vendors/fuelux/js/treeview/tree-custom.js') }}" type="text/javascript"></script>

    <script type="text/javascript">
        $(function () {
            var DataSourceTree = function (options) {
                this._data = options.data;
                this._delay = options.delay;
            };

            DataSourceTree.prototype = {
                data: function (options, callback) {
                    var self = this,
                        id, url;
                    if (typeof options.additionalParameters !== 'undefined') {
                        id = options.additionalParameters.id;
                        url = Routing.generate('hatueysoft_menu_getmenu', {id: id});
                    } else {
                        url = Routing.generate('hatueysoft_menu_getmenu')
                    }

                    $.getJSON(url, function (json) {
                        var data = $.extend(true, [], json);
                        callback({data: data});
                    });

//                    setTimeout(function () {
//                        var data = $.extend(true, [], self._data);
//                        console.log(data);
//                        callback({ data: data });
//
//                    }, this._delay)
                }
            };

            var treeDataSource = new DataSourceTree({
                data: [
                    { name: 'Sales', type: 'folder', 'icon-class':'blue', additionalParameters: { id: 'F1' } },
                    { name: 'Projects', type: 'folder', 'icon-class': 'success', additionalParameters: { id: 'F2' } },
                    { name: 'Reports', type: 'item', additionalParameters: { id: 'I1' } },
                    { name: 'Finance', type: 'item', additionalParameters: { id: 'I2' } }
                ],
                delay: 400
            });

            $('#MyTree').tree({
                dataSource: treeDataSource,
                multiSelect: true,
                loadingHTML: '<div class="tree-loading"><i class="fa fa-rotate-right fa-spin"></i></div>'
            });
        });
    </script>
{% endblock %}
